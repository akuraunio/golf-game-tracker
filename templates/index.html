<!DOCTYPE html>
<html>
<head>
  <title>Login page</title>
</head>

{% with messages = get_flashed_messages() %}
    {% if messages %}
      <ul>
      {% for message in messages %}
        <li>{{ message }}</li>
      {% endfor %}
      </ul>
    {% endif %}
  {% endwith %}

<body>
  {% if session.username %}
  <p>
    You are logged in as {{ session.username }}
  </p>
  <p>
    <a href="/logout">Log out</a>
  </p>
  <details>
      <summary>Update profile</summary>
      <form action="/update_profile" method="post">
        <label>Your golf club<br>
          <input type="text" name="club" value="{{ profile.get('club', '') }}">
        </label><br><br>
        <label>Your favorite course<br>
          <input type="text" name="favorite_course" value="{{ profile.get('favorite_course', '') }}">
        </label><br><br>
        <button type="submit">Save</button>
      </form>
    </details>
    <p>
    <a href="/add_round_page">Add a golf round</a>
    </p>
    {% if rounds %}
    <h2>Rounds played</h2>
    <ul>
        {% for r in rounds %}
        <li>
            <p>{{ r.played_date }}</p>
            <p>{{ r.course }}</p>
            <p>{{ r.played_tee }}</p>
            <p>{{ r.played_strokes }}</p>
            <p>{{ r.holes }}</p>
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <p>No rounds played</p>
    {% endif %}
  {% else %}
  <form action="/login" method="post">
    <p>
      Username: <br />
      <input type="text" name="username" />
    </p>
    <p>
      Password: <br />
      <input type="password" name="password" />
    </p>
    <input type="submit" value="Log in" />
  </form>
  <p>
    <a href="/register">Create a profile</a>
  </p>
  {% endif %}
</body>
</html>